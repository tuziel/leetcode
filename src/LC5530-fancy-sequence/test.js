const process = require('process');
const expect = require('chai').expect;
const { slice64 } = require('../utils');

const func = require('.');
const title = '5530. 奇妙序列';
const tepmlate = ({ input: [cmds, datas], output }) =>
  `输入: ${slice64(cmds)}
            ${slice64(datas)}
      输出: ${slice64(output)}`;

const samples = [
  {
    input: [
      JSON.parse('["Fancy","append","addAll","append","multAll","getIndex","addAll","append","multAll","getIndex","getIndex","getIndex"]'),
      JSON.parse('[[],[2],[3],[7],[2],[0],[3],[10],[2],[0],[1],[2]]'),
    ],
    output: JSON.parse('[null,null,null,null,null,10,null,null,null,26,34,20]'),
  },
  {
    input: [
      JSON.parse('["Fancy","append","append","getIndex","append","getIndex","addAll","append","getIndex","getIndex","append","append","getIndex","append","getIndex","append","getIndex","append","getIndex","multAll","addAll","getIndex","append","addAll","getIndex","multAll","getIndex","multAll","addAll","addAll","append","multAll","append","append","append","multAll","getIndex","multAll","multAll","multAll","getIndex","addAll","append","multAll","addAll","addAll","multAll","addAll","addAll","append","append","getIndex"]'),
      JSON.parse('[[],[12],[8],[1],[12],[0],[12],[8],[2],[2],[4],[13],[4],[12],[6],[11],[1],[10],[2],[3],[1],[6],[14],[5],[6],[12],[3],[12],[15],[6],[7],[8],[13],[15],[15],[10],[9],[12],[12],[9],[9],[9],[9],[4],[8],[11],[15],[9],[1],[4],[10],[9]]'),
    ],
    output: JSON.parse('[null,null,null,8,null,12,null,null,24,24,null,null,4,null,12,null,20,null,24,null,null,37,null,null,42,null,360,null,null,null,null,null,null,null,null,null,220560,null,null,null,285845760,null,null,null,null,null,null,null,null,null,null,150746316]'),
  },
  {
    input: [
      JSON.parse('["Fancy","append","append","append","append","append","append","addAll","multAll","multAll","append","addAll","append","getIndex","addAll","append","append","append","getIndex","multAll","getIndex","getIndex","multAll","getIndex","getIndex","multAll","append","append","append","append","multAll","append","multAll","addAll","getIndex","addAll","addAll","addAll","getIndex","addAll","append","addAll","addAll","addAll","append","multAll","addAll","append","append","addAll","append","addAll","getIndex","append","multAll","getIndex","addAll","multAll","append","append","addAll","append","getIndex","multAll","append","addAll","append","append","getIndex","getIndex","addAll","multAll","getIndex","multAll","getIndex","multAll","append","append","multAll","getIndex","getIndex","multAll","append","multAll","addAll","multAll","multAll","getIndex","append","getIndex"]'),
      JSON.parse('[[],[15],[6],[9],[13],[13],[7],[1],[14],[14],[10],[8],[2],[0],[15],[3],[12],[1],[2],[12],[7],[9],[2],[4],[1],[9],[1],[8],[13],[4],[12],[7],[8],[10],[1],[15],[14],[1],[15],[4],[9],[2],[7],[11],[12],[3],[14],[4],[2],[3],[4],[12],[7],[8],[12],[10],[1],[9],[4],[13],[4],[8],[15],[12],[12],[11],[8],[14],[18],[3],[15],[4],[0],[5],[13],[10],[6],[3],[15],[17],[0],[4],[12],[9],[14],[3],[10],[17],[8],[0]]'),
    ],
    output: JSON.parse('[null,null,null,null,null,null,null,null,null,null,null,null,null,3144,null,null,null,null,1983,null,204,144,null,66408,33480,null,null,null,null,null,null,null,null,null,28926730,null,null,null,96,null,null,null,null,null,null,null,null,null,null,null,null,null,1057757,null,null,749148,null,null,null,null,null,null,42025,null,null,null,null,null,24791,80163678,null,null,735272514,null,102776440,null,null,null,null,253266000,454381643,null,null,null,null,null,null,527278509,null,732171430]'),
  },
  {
    input: [
      JSON.parse('["Fancy","append","getIndex","append","multAll","getIndex","getIndex","addAll","addAll","multAll","append","getIndex","getIndex","multAll","getIndex","addAll","append","multAll","getIndex","getIndex","getIndex","append","addAll","multAll","getIndex","addAll","append","getIndex","getIndex","append","multAll","getIndex","addAll","multAll","multAll","addAll","getIndex","addAll","multAll","getIndex","append","addAll","addAll","append","multAll","getIndex","addAll","append","append","append","addAll","getIndex","append","append","append","getIndex","getIndex","getIndex","getIndex","append","addAll","getIndex","append","append","append","append","multAll","getIndex","append","multAll","getIndex","getIndex","addAll","append","append","append","getIndex","getIndex","getIndex","addAll","addAll","addAll","multAll","getIndex","append","multAll","append","getIndex","append","multAll","getIndex","multAll","getIndex","append","append","multAll","append","getIndex","addAll","addAll","append","multAll","getIndex","append","getIndex","getIndex","append","addAll","append","append","getIndex","addAll","getIndex","append","addAll","append","append","addAll","multAll","append","getIndex","multAll","multAll","addAll","append","multAll","append","getIndex","append","addAll","addAll","getIndex","getIndex","append","append","append","getIndex","getIndex","getIndex","append","addAll","getIndex","append","multAll","append","addAll","multAll","getIndex","getIndex","addAll","append","append","getIndex","append","append","addAll","append","getIndex","getIndex","multAll","getIndex","multAll","append","multAll","getIndex","multAll","addAll","getIndex","addAll","multAll","append","append","getIndex","addAll","append","getIndex","getIndex","multAll","getIndex","getIndex","multAll","multAll","getIndex","getIndex","multAll","getIndex","append","append","addAll","addAll","getIndex","append","getIndex","getIndex","getIndex","addAll","getIndex","multAll","addAll","getIndex","append","addAll","multAll","getIndex","multAll","addAll","multAll","getIndex","append","addAll","getIndex","multAll","multAll","addAll","getIndex","getIndex","getIndex","getIndex","addAll","append","getIndex","append","addAll","addAll","multAll","multAll","append","multAll","getIndex","append","multAll","append","getIndex","addAll","append","addAll","addAll","multAll","multAll","append","getIndex","multAll","append","getIndex","multAll","append","append","addAll","append","multAll","multAll","append","multAll","append","multAll","addAll","multAll","getIndex","append","append","append","addAll","append","getIndex","append","multAll","multAll","append","getIndex","getIndex","addAll","multAll","getIndex","append","getIndex","multAll","append","addAll","append","append","getIndex","addAll","addAll","append","getIndex","append","multAll","append","append","multAll","addAll","multAll","addAll","getIndex","getIndex","multAll","addAll","getIndex","addAll","append","append","addAll","append","getIndex","addAll","append","getIndex","getIndex","getIndex","getIndex","append","multAll","getIndex","append","append","addAll","getIndex","append","append","getIndex","multAll","append","append","addAll","getIndex","append","multAll","append","multAll","multAll","append","multAll","multAll","addAll","addAll","addAll","multAll","getIndex","addAll","append","getIndex","multAll","append","getIndex","append","append","getIndex","getIndex","addAll","getIndex","addAll","addAll","append","multAll","multAll","append","addAll","addAll","addAll","addAll","append","multAll","getIndex","getIndex","append","multAll","append","append","getIndex","append","append","addAll","append","addAll","append","append","getIndex","addAll","getIndex","addAll","multAll","getIndex","addAll","multAll","append","addAll","addAll","multAll","getIndex","multAll","getIndex","getIndex","getIndex","multAll","append","multAll","append","multAll","addAll","getIndex","multAll","getIndex","append","append","append","append","addAll","append","multAll","append","multAll","multAll","multAll","getIndex","addAll","append","multAll","append","multAll","multAll","addAll","getIndex","append","addAll","addAll","multAll","addAll","getIndex","append","addAll","addAll","multAll","multAll","getIndex","getIndex","getIndex","getIndex","getIndex","addAll","getIndex","multAll","append","multAll","append","multAll","getIndex","addAll","append","append","append","multAll","multAll","getIndex","getIndex"]'),
      JSON.parse('[[],[5],[0],[16],[13],[1],[0],[12],[11],[15],[7],[1],[1],[3],[1],[2],[5],[13],[0],[1],[3],[10],[13],[7],[3],[7],[2],[0],[5],[15],[16],[6],[11],[3],[5],[12],[3],[10],[9],[0],[11],[5],[14],[10],[16],[5],[6],[9],[11],[11],[13],[16],[13],[5],[15],[6],[12],[4],[14],[7],[12],[2],[9],[13],[16],[9],[16],[8],[7],[15],[0],[12],[6],[11],[10],[15],[21],[0],[19],[4],[16],[10],[3],[13],[10],[2],[2],[19],[3],[2],[15],[6],[2],[14],[2],[8],[13],[2],[9],[14],[4],[9],[17],[2],[29],[26],[2],[9],[4],[13],[29],[4],[10],[4],[3],[16],[12],[4],[4],[7],[24],[10],[3],[6],[2],[8],[3],[13],[5],[13],[12],[16],[17],[15],[14],[11],[39],[33],[32],[5],[8],[43],[15],[10],[14],[12],[4],[43],[13],[8],[3],[4],[41],[3],[3],[8],[11],[2],[37],[10],[39],[8],[8],[16],[4],[9],[8],[18],[16],[5],[2],[8],[8],[11],[8],[34],[54],[16],[3],[19],[4],[5],[12],[18],[5],[24],[15],[16],[12],[3],[8],[4],[52],[27],[43],[15],[55],[14],[4],[39],[9],[14],[14],[10],[10],[13],[14],[60],[3],[15],[47],[13],[3],[8],[23],[3],[16],[2],[11],[15],[16],[10],[10],[5],[14],[6],[4],[3],[59],[8],[8],[5],[5],[11],[11],[11],[8],[14],[15],[3],[0],[8],[11],[9],[3],[4],[3],[5],[15],[7],[7],[2],[5],[12],[6],[12],[6],[49],[8],[14],[10],[16],[8],[65],[3],[14],[8],[14],[15],[38],[7],[12],[68],[3],[73],[13],[5],[2],[6],[2],[56],[12],[6],[7],[43],[2],[15],[9],[12],[14],[15],[9],[13],[64],[17],[16],[2],[4],[7],[9],[10],[7],[10],[65],[3],[6],[28],[68],[68],[84],[11],[11],[14],[4],[16],[13],[25],[7],[14],[73],[10],[15],[10],[9],[90],[4],[10],[4],[6],[10],[6],[15],[9],[15],[16],[5],[8],[3],[15],[12],[20],[13],[2],[95],[2],[12],[20],[85],[11],[77],[2],[11],[2],[12],[10],[8],[7],[4],[10],[5],[12],[2],[87],[50],[10],[2],[9],[15],[20],[15],[5],[10],[12],[9],[15],[8],[43],[10],[62],[10],[11],[62],[3],[7],[6],[2],[3],[16],[69],[8],[74],[67],[65],[12],[15],[9],[8],[11],[4],[29],[10],[64],[10],[9],[13],[14],[8],[10],[8],[13],[14],[14],[8],[108],[5],[9],[16],[14],[5],[11],[2],[2],[8],[7],[15],[2],[13],[88],[6],[7],[14],[8],[14],[79],[35],[51],[11],[84],[12],[99],[11],[16],[12],[14],[15],[106],[10],[6],[10],[15],[6],[9],[88],[31]]'),
    ],
    output: JSON.parse('[null,null,5,null,null,208,65,null,null,null,null,3465,3465,null,10395,null,null,null,51506,135161,65,null,null,null,546,null,null,360640,2,null,null,240,null,null,null,null,132897,null,null,778984083,null,null,null,null,null,96352,null,null,null,null,null,-1,null,null,null,545651,13,5833331,15,null,null,75748223,null,null,null,null,null,3056,null,null,298938183,6000,null,null,null,null,11,298938189,2166,null,null,null,null,12348,null,null,null,13176,null,null,55152,null,929286876,null,null,null,null,434294959,null,null,null,null,16360911,null,324,2799,null,null,null,null,333,null,44976604,null,null,null,null,null,null,null,70028,null,null,null,null,null,null,484068068,null,null,null,928919363,706493728,null,null,null,41,14473,21193,null,null,22,null,null,null,null,null,928,362723955,null,null,null,1576,null,null,null,null,345499860,617704,null,20240,null,null,null,227269896,null,null,13089314,null,null,null,null,214390178,null,null,274470160,13,null,222192067,511822715,null,null,136973418,942931380,null,671153428,null,null,null,null,24300014,null,13969608,306253315,999249013,null,30430,null,null,448676547,null,null,null,208758218,null,null,null,45262,null,null,198158387,null,null,null,318760831,109113669,318515878,203912356,null,null,318515889,null,null,null,null,null,null,null,472602569,null,null,null,915883068,null,null,null,null,null,null,null,184714327,null,null,646752773,null,null,null,null,null,null,null,null,null,null,null,null,null,191877854,null,null,null,null,null,178607360,null,null,null,null,946229558,223542946,null,null,912882516,null,602196,null,null,null,null,null,234595078,null,null,null,654744698,null,null,null,null,null,null,null,null,532877771,34507480,null,null,204950253,null,null,null,null,null,861195583,null,null,530377211,372785003,372785003,607187,null,null,226418656,null,null,null,888751516,null,null,94867562,null,null,null,null,2339,null,null,null,null,null,null,null,null,null,null,null,null,311801826,null,null,33920794,null,null,518779925,null,null,440970322,214431391,null,678907429,null,null,null,null,null,null,null,null,null,null,null,null,995227471,451513557,null,null,null,null,665764707,null,null,null,null,null,null,null,406255618,null,721312118,null,null,934433359,null,null,null,null,null,null,10100580,null,896648530,72980183,544069400,null,null,null,null,null,null,368673758,null,814356193,null,null,null,null,null,null,null,null,null,null,null,333867562,null,null,null,null,null,null,null,926529496,null,null,null,null,null,591708130,null,null,null,null,null,369108409,975960155,184732551,492234644,900052192,null,472423657,null,null,null,null,null,183114232,null,null,null,null,null,null,728234524,731287988]'),
  },
];

describe(title, function () {
  for (const i of samples) {
    process.send && process.send({ log: tepmlate(i) });
    it(tepmlate(i), function () {
      let fancy;
      const [cmds, datas] = i.input;
      const result = cmds.map((cmd, i) => {
        let temp;
        if (cmd === 'Fancy') fancy = new func();
        else temp = fancy[cmd](...datas[i]);
        return temp || null;
      });
      expect(result).to.deep.equal(i.output);
    });
  }
});
